# TIMELY

## 背景

TIMELY是第一个在数据中心使用的基于延迟的拥塞控制协议。按照拥塞通知的实现，目前主要有两种类型的拥塞控制协议：基于ECN的拥塞控制和基于延时的拥塞控制。

**RTT作为拥塞信号的优点**

RTT之所以有价值，是因为它们直接衡量我们关心的数量： 网络排队导致的端到端延迟。而从队列占用率得出的信号（例如ECN）无法直接告知该指标，数据包上的ECN标记仅表示与数据包相对应的队列度量值超过阈值。具有不同优先级的多个队列共享同一输出链路，但是ECN标记仅提供有关占用率超过阈值的队列的信息。低优先级的流量可能会经历较大的排队延迟，而不必具有大的队列占用率。在这种情况下，排队延迟反映了网络中的拥塞状态，而低优先级流量的队列占用率却没有反映该问题。此外，ECN标记描述了单个交换机的行为。在利用率很高的网络中，拥塞发生在多个交换机上，ECN信号在它们之间无法分辨。

而且目前使用网卡硬件的形式来进行RTT测量具有很高的精确度（微秒级别）。


## TIMELY算法

TIMELY为速率控制提供了一个框架，下图显示了它的三个组成部分：

* RTT Measurement Engine：测量RTT，监视网络的拥塞情况；
* Rate Computation Engine：将RTT信号转换为目标发送速率的计算引擎；
* Rate Control Engine：在各段（64KB each）之间插入延迟以达到目标速率。

### RTT Measurement Engine

该组件实现了对RTT的测量。首先介绍一下时延。网络时延主要由四个部分组成：发送时延、传播时延、处理时延（网卡产生ACK的时延）和排队时延。论文将RTT定义为传播时延+排队时延。对于发送时延，就是网卡将数据包发送到链路上的时间，等于数据包的尺寸除以网卡带宽，处理时延，即网卡产生ACK的时延接近零，因此忽略不计。因此本文中RTT的计算如下式：

RTT = T*completion* - T*send* - seg.size / NIC*linerate*








### Rate Computation Engine

### Rate Control Engine


## 总结

